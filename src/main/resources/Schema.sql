drop table if exists author CASCADE;
drop table if exists book CASCADE;
drop table if exists books_authors CASCADE;
drop table if exists books_categories CASCADE;
drop table if exists category CASCADE;
drop table if exists photo CASCADE;
create table author (author_id bigint generated by default as identity, birth_date timestamp, first_name varchar(255) not null, last_name varchar(255) not null, primary key (author_id));
create table book (book_id bigint generated by default as identity, isbn bigint, published_date timestamp, rating double, title varchar(255) not null, total_pages integer, photo_id bigint, primary key (book_id));
create table books_authors (author_id bigint not null, book_id bigint not null);
create table books_categories (book_id bigint not null, category_id bigint not null);
create table category (category_id bigint generated by default as identity, category varchar(255) not null, parent_id bigint, primary key (category_id));
create table photo (photo_id bigint generated by default as identity, url_large varchar(255) not null, url_medium varchar(255) not null, url_small varchar(255) not null, primary key (photo_id));
alter table book add constraint FKc4kkvusmioiqpnhuhic8wsjsv foreign key (photo_id) references photo;
alter table books_authors add constraint FK6ojkw2gy23xsgdkqih628favt foreign key (book_id) references book;
alter table books_authors add constraint FKov77rfnon6gwd8emlsah05qty foreign key (author_id) references author;
alter table books_categories add constraint FKkksgsy7k6sy1hr55se8mpktvb foreign key (category_id) references category;
alter table books_categories add constraint FKb9cxhvxrdqagj2np5dliseash foreign key (book_id) references book;
alter table category add constraint FK2y94svpmqttx80mshyny85wqr foreign key (parent_id) references category;

commit;